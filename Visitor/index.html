<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Visitor Design Pattern</title>
        <link rel="stylesheet" href="../styles.css" />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css"
        />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

        <!-- and it's easy to individually load additional languages -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>
    </head>
    <body>
        <div class="container">
            <nav class="navbar">
                <div class="navbar-brand">
                    <a href="../">Design Patterns</a>
                </div>
                <ul class="navbar-nav">
                    <li><a href="../">Home</a></li>
                </ul>
            </nav>
            <h1 id="visitor-design-pattern">Visitor Design Pattern</h1>
            <p>
                Visitor design pattern is one of the behavioral design patterns.
                It is used when we have to perform an operation on a group of
                similar kind of Objects. With the help of visitor pattern, we
                can move the operational logic from the objects to another
                class. The visitor pattern consists of two parts:
            </p>
            <ul>
                <li>
                    a method called <code>visit()</code> which is implemented by
                    the visitor and is called for every element in the data
                    structure
                </li>
                <li>
                    visitable classes providing <code>accept()</code> methods
                    that accept a visitor
                </li>
            </ul>
            <h2 id="table-of-contents">Table of Contents</h2>
            <ul>
                <li><a href="#components">Components</a></li>
                <li><a href="#implementation">Implementation</a></li>
            </ul>
            <h2 id="components">Components</h2>
            <ul>
                <li>
                    <strong>Client</strong> : The Client class is a consumer of
                    the classes of the visitor design pattern. It has access to
                    the data structure objects and can instruct them to accept a
                    Visitor to perform the appropriate processing.
                </li>
                <li>
                    <strong>Visitor</strong> : This is an interface or an
                    abstract class used to declare the visit operations for all
                    the types of visitable classes.
                </li>
                <li>
                    <strong>ConcreteVisitor</strong> : For each type of visitor
                    all the visit methods, declared in abstract visitor, must be
                    implemented. Each Visitor will be responsible for different
                    operations.
                </li>
                <li>
                    <strong>Visitable</strong> : This is an interface which
                    declares the accept operation. This is the entry point which
                    enables an object to be “visited” by the visitor object.
                </li>
                <li>
                    <strong>ConcreteVisitable</strong> : These classes implement
                    the Visitable interface or class and defines the accept
                    operation. The visitor object is passed to this object using
                    the accept operation.
                </li>
            </ul>
            <h2 id="implementation">Implementation</h2>
            <ul>
                <li><strong>Visitor</strong>:</li>
            </ul>
            <pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">ShoppingCartVisitor</span> {
    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">visit</span>(<span class="hljs-params">Book book</span>)</span>;
    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">visit</span>(<span class="hljs-params">Fruit fruit</span>)</span>;
}
</code></pre>
            <ul>
                <li><strong>ConcreteVisitor</strong>:</li>
            </ul>
            <pre><code class="lang-java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ShoppingCartVisitorImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ShoppingCartVisitor</span>
</span>{

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">visit</span><span class="hljs-params">(Book book)</span>
    </span>{
        <span class="hljs-keyword">int</span> cost=<span class="hljs-number">0</span>;
        <span class="hljs-comment">//apply 5$ discount if book price is greater than 50</span>
        <span class="hljs-keyword">if</span>(book.getPrice() &gt; <span class="hljs-number">50</span>)
        {
            cost = book.getPrice()-<span class="hljs-number">5</span>;
        }
        <span class="hljs-keyword">else</span>
            cost = book.getPrice();

        System.out.println(<span class="hljs-string">"Book ISBN::"</span>+book.getIsbnNumber() + <span class="hljs-string">" cost ="</span>+cost);
        <span class="hljs-keyword">return</span> cost;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">visit</span><span class="hljs-params">(Fruit fruit)</span>
    </span>{
        <span class="hljs-keyword">int</span> cost = fruit.getPricePerKg()*fruit.getWeight();
        System.out.println(fruit.getName() + <span class="hljs-string">" cost = "</span>+cost);
        <span class="hljs-keyword">return</span> cost;
    }

}
</code></pre>
            <ul>
                <li><strong>Visitable</strong>:</li>
            </ul>
            <pre><code class="lang-java"><span class="hljs-keyword">interface</span> <span class="hljs-title">ItemElement</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">accept</span>(<span class="hljs-params">ShoppingCartVisitor visitor</span>)</span>;
}
</code></pre>
            <ul>
                <li><strong>ConcreteVisitable</strong>:</li>
            </ul>
            <pre><code class="lang-java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Book</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ItemElement</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> price;
    <span class="hljs-keyword">private</span> String isbnNumber;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Book</span><span class="hljs-params">(<span class="hljs-keyword">int</span> cost, String isbn)</span>
    </span>{
        <span class="hljs-keyword">this</span>.price=cost;
        <span class="hljs-keyword">this</span>.isbnNumber=isbn;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getPrice</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> price;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function">String <span class="hljs-title">getIsbnNumber</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> isbnNumber;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">accept</span><span class="hljs-params">(ShoppingCartVisitor visitor)</span>
    </span>{
        <span class="hljs-function"><span class="hljs-keyword">return</span> visitor.<span class="hljs-title">visit</span><span class="hljs-params">(<span class="hljs-keyword">this</span>)</span></span>;
    }

}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Fruit</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ItemElement</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> pricePerKg;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> weight;
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Fruit</span><span class="hljs-params">(<span class="hljs-keyword">int</span> priceKg, <span class="hljs-keyword">int</span> wt, String nm)</span>
    </span>{
        <span class="hljs-keyword">this</span>.pricePerKg=priceKg;
        <span class="hljs-keyword">this</span>.weight=wt;
        <span class="hljs-keyword">this</span>.name = nm;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getPricePerKg</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> pricePerKg;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getWeight</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> weight;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function">String <span class="hljs-title">getName</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">accept</span><span class="hljs-params">(ShoppingCartVisitor visitor)</span>
    </span>{
        <span class="hljs-function"><span class="hljs-keyword">return</span> visitor.<span class="hljs-title">visit</span><span class="hljs-params">(<span class="hljs-keyword">this</span>)</span></span>;
    }

}
</code></pre>
            <ul>
                <li><strong>Client</strong>:</li>
            </ul>
            <pre><code class="lang-java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ShoppingCartClient</span>
</span>{

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> main(String[] args)
    {
        ItemElement[] items = <span class="hljs-keyword">new</span> ItemElement[]{<span class="hljs-keyword">new</span> Book(<span class="hljs-number">20</span>, <span class="hljs-string">"1234"</span>),
                              <span class="hljs-keyword">new</span> Book(<span class="hljs-number">100</span>, <span class="hljs-string">"5678"</span>), <span class="hljs-keyword">new</span> Fruit(<span class="hljs-number">10</span>, <span class="hljs-number">2</span>, <span class="hljs-string">"Banana"</span>),
                              <span class="hljs-keyword">new</span> Fruit(<span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-string">"Apple"</span>)};

        <span class="hljs-keyword">int</span> total = calculatePrice(items);
        System.out.println(<span class="hljs-string">"Total Cost = "</span>+total);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> calculatePrice(ItemElement[] items)
    {
        ShoppingCartVisitor visitor = <span class="hljs-keyword">new</span> ShoppingCartVisitorImpl();
        <span class="hljs-keyword">int</span> <span class="hljs-keyword">sum</span>=<span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span>(ItemElement item : items)
        {
            <span class="hljs-keyword">sum</span> = <span class="hljs-keyword">sum</span> + item.accept(visitor);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">sum</span>;
    }

}
</code></pre>
        </div>
    </body>
</html>
